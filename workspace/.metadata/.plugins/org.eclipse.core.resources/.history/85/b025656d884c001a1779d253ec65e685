package algospot;

import java.util.*;
public class Numb3rs {

	static int n;
	static int d;
	static int p;
	static int[][] connected = new int[50][50];
	static int t;
	static int[] village = new int[50];
	static int q;
	static double[][] cache = new double[51][101];
	
	static int[] degree = new int[50];
	
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		Scanner scan = new Scanner(System.in);
		int c = scan.nextInt();
		
		for(int test=1; test<=c; test++) {
			n = scan.nextInt();
			d = scan.nextInt();
			p = scan.nextInt();
			
			for(int i=0; i<n; i++) {
				for(int j=0; j<n; j++) {
					connected[i][j] = scan.nextInt();
				}
			}
		
			t = scan.nextInt();
			for(int i=0; i<t; i++) {
				village[i] = scan.nextInt(); 
			}
			
			// 각 마을에 연결된 다른 마을의 수를 미리 저장해둠
			for(int i=0; i<n; i++) {
				int count = 0;
				for(int j=0; j<n; j++) {
					if(connected[i][j] == 1) {
						count++;
					}
				}
				degree[i] = count;
			}
			
			for(int[] row : cache) {
				Arrays.fill(row, -1);
			}
			
			for(int i=0; i<t; i++) {
				q = village[i];
				double result = search2(p, 0);
				String strResult = String.format("%.8f", result);
				System.out.print(strResult + " ");
			}
			System.out.println();
		}
	}
	
	public static double search2(int here, int days) {
		// 기저 사례: d일이 지난 경우
		if(days == d) {
			return here == q ? 1.0 : 0.0;
		}
		
		if(cache[here][days] > -0.5) {
			return cache[here][days];
		}
		
		double ret = 0;
		for(int there=0; there<n; there++) {
			if(connected[here][there] == 1) {
				ret += search2(there, days+1) / degree[here];
			}
		}
		cache[here][days] = ret;
		return ret;
	}
}
